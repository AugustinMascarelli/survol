<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Experimentation: Embed SVG document generated in Python, in a DIV tag</title>
</head>
<body>

<script type="javascript">
alert('a');
</script>


Peut-etre pourrait-on aussi utiliser les DIV pour melanger Python et HTML ? autre chose: S'assurer que nos URLs
sont faciles a reproduire en WSGI. En fait c est plutot une iframe ?
On ne pourra pas acceder le contenu de la iframe en Javascript if it is cross-domain,
mais justement on s'en fout car on a un seul serveur.

This contains a SVG document generated on the fly:<br>

<iframe src="htbin/entity.py" width="100%" height="600" id="entity_iframe" onload="PrintContent()">
     <p>Your browser does not support iframes.</p>
</iframe>

On peut ajouter des url qui appeleront du java script etc...<br>
Lister le contenu de ce document.


<table>
	<tr>
		<td><div id="OurComments">
</div></td>

		<td valign="top">
			<table id="myTable" border="1">
    <thead>
        <tr>
            <th>RDF links</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>aaaaa</td>
        </tr>
    </tbody>
</table></td>

	</tr>

</table>


<script>

function ProcessClick(theTxt,theUrl)
{
	// alert("Another "+theTxt);
	var tableRef = document.getElementById('myTable').getElementsByTagName('tbody')[0];

	// Insert a row in the table at the last row
	var newRow = tableRef.insertRow(tableRef.rows.length);

	// Insert a cell in the row at index 0
	var newCell0 = newRow.insertCell(0);

	// Append a text node to the cell
	var newText = document.createTextNode(theTxt)
	newCell0.appendChild(newText);

	var newCell1 = newRow.insertCell(1);

	// Append a text node to the cell
	var newText = document.createTextNode(theUrl)
	newCell1.appendChild(newText);
}


// We should wait until the iframe is loaded
function PrintContent()
{
	// return
	var divComments = document.getElementById('OurComments');

	divComments.innerHTML = ""
	divComments.innerHTML += "Conclusion:<br>";
	var iframe = document.getElementById('entity_iframe');
	divComments.innerHTML += "type iframe="+iframe.contentDocument.contentType + "<br>";

	/* The document we are pointing to. Depends on the browser */
	var iframeDocument = iframe.contentDocument || iframe.contentWindow.document;

	var listNodes = iframeDocument.getElementsByClassName('node');
	divComments.innerHTML += "Nodes:" + listNodes.length + "<br>";
	for( var ixNode = 0; ixNode < listNodes.length; ixNode++ )
	{
		var node = listNodes[ixNode]
		var title = node.getElementsByTagName("title")[0].textContent;

		divComments.innerHTML += ixNode + "= " + node.id + " " + title + "<br>";


		// Now looks for the subnode which contains the string and the url.
		var listSubNodes = node.getElementsByTagName("g");
		for( var ixSubNode = 0; ixSubNode < listSubNodes.length; ixSubNode++ )
		{
			var subNode = listSubNodes[ixSubNode];
			// <g id="a_node30_31"><

			// var text = subNode.getElementsByTagName("text");

			if (subNode.id)
			{
				/*
				5= node22 nd_30
				1= a_node22_7 : RpcEptMapper
				*/
   				var textNode = subNode.getElementsByTagName("text")[0]; // .textContent;

				if( textNode )
				{
					var hrefUrl = subNode.getElementsByTagName("a")[0].getAttribute("xlink:href");
					var txtContent = textNode.textContent;
					divComments.innerHTML += "&nbsp;&nbsp;&nbsp;" + ixSubNode + "= " + subNode.id + " : " + txtContent +" L="+hrefUrl + "<br>";

					// Click specifiquement sur le texte
					textNode.param_Text = txtContent;
					textNode.param_Url = hrefUrl;
					myFunc = function (evt)
					{
						// alert("Texte="+evt.target.myParam);
						ProcessClick(evt.target.param_Text,evt.target.param_Url);
						// Otherwise it is called several times.
						evt.stopPropagation ? evt.stopPropagation() : (evt.cancelBubble=true);
					};
					textNode.addEventListener("click", myFunc);
				}
			}
		}

		node.setAttribute("onmouseover", "evt.target.setAttribute('opacity', '0.5');");
		node.setAttribute("onmouseout", "evt.target.setAttribute('opacity', '1');");
		/*
		node.myParam = 'This is my parameter';
		node.addEventListener("click", function (evt) {
			// alert("Evt="+evt.target.myParam);
			AnotherAlert("Main:"+evt.target.myParam);
		});
		*/
	}
	
	divComments.innerHTML += "<br><br>";

	var listEdges = iframeDocument.getElementsByClassName('edge');
	divComments.innerHTML += "Edges:" + listEdges.length + "<br>";
	for( var ixEdge = 0; ixEdge < listEdges.length; ixEdge++ )
	{
		var edge = listEdges[ixEdge];

		var title = edge.getElementsByTagName("title")[0].textContent;

		// 19= edge17 nd_19->nd_11
		divComments.innerHTML += ixEdge + "= " + edge.id + "  " + title + "<br>";
	}

	
	divComments.innerHTML += "<br><br>";
	
}

// alert('a');
var iframe = document.getElementById('entity_iframe');
if ( iframe )
{
	/* The document we are pointing to. Depends on the browser */
	var iframeDocument = iframe.contentDocument || iframe.contentWindow.document;

	var divComments = document.getElementById('OurComments');
	divComments.innerHTML += "Before TimeOut<br>";

	// If we do this immediately, the content of the frane is not loaded and still points to the main document.
	// setTimeout(PrintContent, 1000);
	

	/* Oui mais c'est un document en SVG ? */
	// var iBody = iframeDocument.body.innerHTML;
}
else
{
	alert("iframe is null");
}


</script>

<br>
http://www.graphviz.org/content/how-insert-javascript-action-generated-svg



</body>
</html>